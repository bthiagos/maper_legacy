if(!String.trim)String.prototype.trim=function(){return this.replace(/^\s+|\s+$/,'')};var DHTMLSuite_funcs=new Object();if(!window.DHTML_SUITE_THEME)var DHTML_SUITE_THEME='blue';if(!window.DHTML_SUITE_THEME_FOLDER)var DHTML_SUITE_THEME_FOLDER='../themes/';if(!window.DHTML_SUITE_JS_FOLDER)var DHTML_SUITE_JS_FOLDER='../js/separateFiles/';var DHTMLSuite=new Object();var standardObjectsCreated=false;DHTMLSuite.eventEls=new Array();var widgetDep=new Object();widgetDep['formValidator']=['dhtmlSuite-formUtil.js'];widgetDep['paneSplitter']=['dhtmlSuite-paneSplitter.js','dhtmlSuite-paneSplitterModel.js','dhtmlSuite-dynamicContent.js','ajax.js'];widgetDep['menuBar']=['dhtmlSuite-menuBar.js','dhtmlSuite-menuItem.js','dhtmlSuite-menuModel.js'];widgetDep['windowWidget']=['dhtmlSuite-windowWidget.js','dhtmlSuite-resize.js','dhtmlSuite-dragDropSimple.js','ajax.js','dhtmlSuite-dynamicContent.js'];widgetDep['colorWidget']=['dhtmlSuite-colorWidgets.js','dhtmlSuite-colorUtil.js'];widgetDep['colorSlider']=['dhtmlSuite-colorWidgets.js','dhtmlSuite-colorUtil.js','dhtmlSuite-slider.js'];widgetDep['colorPalette']=['dhtmlSuite-colorWidgets.js','dhtmlSuite-colorUtil.js'];widgetDep['calendar']=['dhtmlSuite-calendar.js','dhtmlSuite-dragDropSimple.js'];widgetDep['dragDropTree']=['dhtmlSuite-dragDropTree.js'];widgetDep['slider']=['dhtmlSuite-slider.js'];widgetDep['dragDrop']=['dhtmlSuite-dragDrop.js'];widgetDep['imageEnlarger']=['dhtmlSuite-imageEnlarger.js','dhtmlSuite-dragDropSimple.js'];widgetDep['imageSelection']=['dhtmlSuite-imageSelection.js'];widgetDep['floatingGallery']=['dhtmlSuite-floatingGallery.js','dhtmlSuite-mediaModel.js'];widgetDep['contextMenu']=['dhtmlSuite-contextMenu.js','dhtmlSuite-menuBar.js','dhtmlSuite-menuItem.js','dhtmlSuite-menuModel.js'];widgetDep['dynamicContent']=['dhtmlSuite-dynamicContent.js','ajax.js'];widgetDep['textEdit']=['dhtmlSuite-textEdit.js','dhtmlSuite-textEditModel.js','dhtmlSuite-listModel.js'];widgetDep['listModel']=['dhtmlSuite-listModel.js'];widgetDep['resize']=['dhtmlSuite-resize.js'];widgetDep['dragDropSimple']=['dhtmlSuite-dragDropSimple.js'];widgetDep['dynamicTooltip']=['dhtmlSuite-dynamicTooltip.js','dhtmlSuite-dynamicContent.js','ajax.js'];widgetDep['modalMessage']=['dhtmlSuite-modalMessage.js','dhtmlSuite-dynamicContent.js','ajax.js'];widgetDep['tableWidget']=['dhtmlSuite-tableWidget.js','ajax.js'];widgetDep['progressBar']=['dhtmlSuite-progressBar.js'];widgetDep['tabView']=['dhtmlSuite-tabView.js','dhtmlSuite-dynamicContent.js','ajax.js'];widgetDep['infoPanel']=['dhtmlSuite-infoPanel.js','dhtmlSuite-dynamicContent.js','ajax.js'];widgetDep['form']=['dhtmlSuite-formUtil.js','dhtmlSuite-dynamicContent.js','ajax.js'];widgetDep['autoComplete']=['dhtmlSuite-autoComplete.js','ajax.js'];widgetDep['chainedSelect']=['dhtmlSuite-chainedSelect.js','ajax.js'];var depCache=new Object();DHTMLSuite.include=function(widget){if(!widgetDep[widget]){alert('Cannot find the files for widget '+widget+'. Please verify that the name is correct');return}
var files=widgetDep[widget];for(var no=0;no<files.length;no++){if(!depCache[files[no]]){document.write('<'+'script');document.write(' language="javascript"');document.write(' type="text/javascript"');document.write(' src="'+DHTML_SUITE_JS_FOLDER+files[no]+'">');document.write('</'+'script'+'>');depCache[files[no]]=true}}}
DHTMLSuite.discardElement=function(element){element=DHTMLSuite.commonObj.getEl(element);var gBin=document.getElementById('IELeakGBin');if(!gBin){gBin=document.createElement('DIV');gBin.id='IELeakGBin';gBin.style.display='none';document.body.appendChild(gBin)}
gBin.appendChild(element);gBin.innerHTML=''}
DHTMLSuite.createStandardObjects=function(){DHTMLSuite.clientInfoObj=new DHTMLSuite.clientInfo();DHTMLSuite.clientInfoObj.init();if(!DHTMLSuite.configObj){DHTMLSuite.configObj=new DHTMLSuite.config();DHTMLSuite.configObj.init()}
DHTMLSuite.commonObj=new DHTMLSuite.common();DHTMLSuite.variableStorage=new DHTMLSuite.globalVariableStorage();;DHTMLSuite.commonObj.init();DHTMLSuite.domQueryObj=new DHTMLSuite.domQuery();DHTMLSuite.commonObj.addEvent(window,'unload',function(){DHTMLSuite.commonObj.__clearMemoryGarbage()});standardObjectsCreated=true}
DHTMLSuite.config=function(){var imagePath;var cssPath;var defaultCssPath;var defaultImagePath}
DHTMLSuite.config.prototype={init:function(){this.imagePath=DHTML_SUITE_THEME_FOLDER+DHTML_SUITE_THEME+'/images/';this.cssPath=DHTML_SUITE_THEME_FOLDER+DHTML_SUITE_THEME+'/css/';this.defaultCssPath=this.cssPath;this.defaultImagePath=this.imagePath},setCssPath:function(newCssPath){this.cssPath=newCssPath},resetCssPath:function(){this.cssPath=this.defaultCssPath},resetImagePath:function(){this.imagePath=this.defaultImagePath},setImagePath:function(newImagePath){this.imagePath=newImagePath}}
DHTMLSuite.globalVariableStorage=function(){var menuBar_highlightedItems;this.menuBar_highlightedItems=new Array();var arrayDSObjects;var arrayOfDhtmlSuiteObjects;this.arrayDSObjects=new Array();this.arrayOfDhtmlSuiteObjects=this.arrayDSObjects;var ajaxObjects;this.ajaxObjects=new Array()}
DHTMLSuite.globalVariableStorage.prototype={}
DHTMLSuite.common=function(){var loadedCSSFiles;var cssCacheStatus;var eventEls;var isOkToSelect;this.okToSelect=true;this.cssCacheStatus=true;this.eventEls=new Array()}
DHTMLSuite.common.prototype={init:function(){this.loadedCSSFiles=new Array()},loadCSS:function(cssFile,prefixConfigPath){if(!prefixConfigPath&&prefixConfigPath!==false)prefixConfigPath=true;if(!this.loadedCSSFiles[cssFile]){this.loadedCSSFiles[cssFile]=true;var lt=document.createElement('LINK');if(!this.cssCacheStatus){if(cssFile.indexOf('?')>=0)cssFile=cssFile+'&';else cssFile=cssFile+'?';cssFile=cssFile+'rand='+Math.random()}
if(prefixConfigPath){lt.href=DHTMLSuite.configObj.cssPath+cssFile}else{lt.href=cssFile}
lt.rel='stylesheet';lt.media='screen';lt.type='text/css';document.getElementsByTagName('HEAD')[0].appendChild(lt)}},__setTextSelOk:function(okToSelect){this.okToSelect=okToSelect},__isTextSelOk:function(){return this.okToSelect},setCssCacheStatus:function(cssCacheStatus){this.cssCacheStatus=cssCacheStatus},getEl:function(elRef){if(typeof elRef=='string'){if(document.getElementById(elRef))return document.getElementById(elRef);if(document.forms[elRef])return document.forms[elRef];if(document[elRef])return document[elRef];if(window[elRef])return window[elRef]}
return elRef},isArray:function(el){if(el.constructor.toString().indexOf("Array")!=-1)return true;return false},getStyle:function(el,property){el=this.getEl(el);if(document.defaultView&&document.defaultView.getComputedStyle){var retVal=null;var comp=document.defaultView.getComputedStyle(el,'');if(comp){retVal=comp[property]}
return el.style[property]||retVal}
if(document.documentElement.currentStyle&&DHTMLSuite.clientInfoObj.isMSIE){var retVal=null;if(el.currentStyle)value=el.currentStyle[property];return(el.style[property]||retVal)}
return el.style[property]},getLeftPos:function(el){if(document.getBoxObjectFor){if(el.tagName!='INPUT'&&el.tagName!='SELECT'&&el.tagName!='TEXTAREA')return document.getBoxObjectFor(el).x
}
var returnValue=el.offsetLeft;while((el=el.offsetParent)!=null){if(el.tagName!='HTML'){returnValue+= el.offsetLeft;if(document.all)returnValue+=el.clientLeft}}
return returnValue},getTopPos:function(el){if(document.getBoxObjectFor){if(el.tagName!='INPUT'&&el.tagName!='SELECT'&&el.tagName!='TEXTAREA')return document.getBoxObjectFor(el).y
}
var returnValue=el.offsetTop;while((el=el.offsetParent)!=null){if(el.tagName!='HTML'){returnValue+=(el.offsetTop-el.scrollTop);if(document.all)returnValue+=el.clientTop}}
return returnValue},getCookie:function(name){var start=document.cookie.indexOf(name+"=");var len=start+name.length+1;if((!start)&&(name!=document.cookie.substring(0,name.length)))return null;if(start==-1)return null;var end=document.cookie.indexOf(";",len);if(end==-1)end=document.cookie.length;return unescape(document.cookie.substring(len,end))},setCookie:function(name,value,expires,path,domain,secure){expires=expires*60*60*24*1000;var today=new Date();var expires_date=new Date(today.getTime()+(expires));var cookieString=name+"="+escape(value)+
((expires)?";expires="+expires_date.toGMTString():"")+
((path)?";path="+path:"")+
((domain)?";domain="+domain:"")+
((secure)?";secure":"");document.cookie=cookieString},deleteCookie:function(name,path,domain){if(this.getCookie(name))document.cookie=name+"="+
((path)?";path="+path:"")+
((domain)?";domain="+domain:"")+
";expires=Thu,01-Jan-1970 00:00:01 GMT"},cancelEvent:function(){return false},addEvent:function(obj,type,fn,suffix){if(!suffix)suffix='';if(obj.attachEvent){if(typeof DHTMLSuite_funcs[type+fn+suffix]!='function'){DHTMLSuite_funcs[type+fn+suffix]=function(){fn.apply(window.event.srcElement)};obj.attachEvent('on'+type,DHTMLSuite_funcs[type+fn+suffix])}
obj=null} else {obj.addEventListener(type,fn,false)}
this.__addEventEl(obj)},removeEvent:function(obj,type,fn,suffix){if(obj.detachEvent){obj.detachEvent('on'+type,DHTMLSuite_funcs[type+fn+suffix]);DHTMLSuite_funcs[type+fn+suffix]=null;obj=null} else {obj.removeEventListener(type,fn,false)}},__clearMemoryGarbage:function(){if(!DHTMLSuite.clientInfoObj.isMSIE)return;for(var no=0;no<DHTMLSuite.eventEls.length;no++){try{var el=DHTMLSuite.eventEls[no];el.onclick=null;el.onmousedown=null;el.onmousemove=null;el.onmouseout=null;el.onmouseover=null;el.onmouseup=null;el.onfocus=null;el.onblur=null;el.onkeydown=null;el.onkeypress=null;el.onkeyup=null;el.onselectstart=null;el.ondragstart=null;el.oncontextmenu=null;el.onscroll=null;el=null}catch(e){}}
for(var no in DHTMLSuite.variableStorage.arrayDSObjects){DHTMLSuite.variableStorage.arrayDSObjects[no]=null}
window.onbeforeunload=null;window.onunload=null;DHTMLSuite=null},__addEventEl:function(el){DHTMLSuite.eventEls[DHTMLSuite.eventEls.length]=el},getSrcElement:function(e){var el;if(e.target)el=e.target;else if(e.srcElement)el=e.srcElement;if(el.nodeType==3)
el=el.parentNode;return el},getKeyFromEvent:function(e){var code=this.getKeyCode(e);return String.fromCharCode(code)},getKeyCode:function(e){if(e.keyCode)code=e.keyCode;else if(e.which)code=e.which;return code},isObjectClicked:function(obj,e){var src=this.getSrcElement(e);var string=src.tagName+'('+src.className+')';if(src==obj)return true;while(src.parentNode&&src.tagName.toLowerCase()!='html'){src=src.parentNode;string=string+','+src.tagName+'('+src.className+')';if(src==obj)return true}
return false},getObjectByClassName:function(e,className){var src=this.getSrcElement(e);if(src.className==className)return src;while(src&&src.tagName.toLowerCase()!='html'){src=src.parentNode;if(src.className==className)return src}
return false},getObjectByAttribute:function(e,attribute){var src=this.getSrcElement(e);var att=src.getAttribute(attribute);if(!att)att=src[attribute];if(att)return src;while(src&&src.tagName.toLowerCase()!='html'){src=src.parentNode;var att=src.getAttribute('attribute');if(!att)att=src[attribute];if(att)return src}
return false},getUniqueId:function(){var no=Math.random()+'';no=no.replace('.','');var no2=Math.random()+'';no2=no2.replace('.','');return no+no2},getAssociativeArrayFromString:function(propertyString){if(!propertyString)return;var retArray=new Array();var items=propertyString.split(/,/g);for(var no=0;no<items.length;no++){var tokens=items[no].split(/:/);retArray[tokens[0]]=tokens[1]}
return retArray},correctPng:function(el){el=DHTMLSuite.commonObj.getEl(el);var img=el;var width=img.width;var height=img.height;var html='<span style="display:inline-block;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src=\''+img.src+'\',sizingMethod=\'scale\');width:'+width+';height:'+height+'"></span>';img.outerHTML=html},__evaluateJs:function(obj){obj=this.getEl(obj);var scriptTags=obj.getElementsByTagName('SCRIPT');var string='';var jsCode='';for(var no=0;no<scriptTags.length;no++){if(scriptTags[no].src){var head=document.getElementsByTagName("head")[0];var scriptObj=document.createElement("script");scriptObj.setAttribute("type","text/javascript");scriptObj.setAttribute("src",scriptTags[no].src)}else{if(DHTMLSuite.clientInfoObj.isOpera){jsCode=jsCode+scriptTags[no].text+'\n'}
else
jsCode=jsCode+scriptTags[no].innerHTML}}
if(jsCode)this.__installScript(jsCode)},__installScript:function(script){try{if(!script)
return;if(window.execScript){window.execScript(script)
}else if(window.jQuery&&jQuery.browser.safari){window.setTimeout(script,0)}else{window.setTimeout(script,0)}}catch(e){}},__evaluateCss:function(obj){obj=this.getEl(obj);var cssTags=obj.getElementsByTagName('STYLE');var head=document.getElementsByTagName('HEAD')[0];for(var no=0;no<cssTags.length;no++){head.appendChild(cssTags[no])}}}
DHTMLSuite.clientInfo=function(){var browser;var isOpera;var isMSIE;var isOldMSIE;var isFirefox;var navigatorVersion;var isOldMSIE}
DHTMLSuite.clientInfo.prototype={init:function(){this.browser=navigator.userAgent;this.isOpera=(this.browser.toLowerCase().indexOf('opera')>=0)?true:false;this.isFirefox=(this.browser.toLowerCase().indexOf('firefox')>=0)?true:false;this.isMSIE=(this.browser.toLowerCase().indexOf('msie')>=0)?true:false;this.isOldMSIE=(this.browser.toLowerCase().match(/msie\s[0-6]/gi))?true:false;this.isSafari=(this.browser.toLowerCase().indexOf('safari')>=0)?true:false;this.navigatorVersion=navigator.appVersion.replace(/.*?MSIE\s(\d\.\d).*/g,'$1')/1;this.isOldMSIE=(this.isMSIE&&this.navigatorVersion<7)?true:false},getBrowserWidth:function(){if(self.innerWidth)return self.innerWidth;return document.documentElement.offsetWidth},getBrowserHeight:function(){if(self.innerHeight)return self.innerHeight;return document.documentElement.offsetHeight}}
DHTMLSuite.domQuery=function(){document.getElementsByClassName=this.getElementsByClassName;document.getElementsByAttribute=this.getElementsByAttribute}
DHTMLSuite.domQuery.prototype={}
DHTMLSuite.tableWidgetPageHandler=function(){var tableRef;var targetRef;var txtPrevious;var txtNext;var txtFirst;var txtLast;var txtResultPrefix;var txtResultTo;var txtResultOf;var totalNumberOfRows;var rowsPerPage;var layoutCSS;var activePageNumber;var mainDivEl;var resultDivElement;var pageListDivEl;var objectIndex;var linkPagePrefix;var linkPageSuffix;var maximumNumberOfPageLinks;var callbackOnAfterNavigate;this.txtPrevious='Previous';this.txtNext='Next';this.txtResultPrefix='Result: ';this.txtResultTo='to';this.txtResultOf='of';this.txtFirst='First';this.txtLast='Last';this.tableRef=false;this.targetRef=false;this.totalNumberOfRows=false;this.activePageNumber=0;this.layoutCSS='table-widget-page-handler.css';this.linkPagePrefix='';this.linkPageSuffix='';this.maximumNumberOfPageLinks=false;this.callbackOnAfterNavigate=false;this.objectIndex=DHTMLSuite.variableStorage.arrayDSObjects.length;DHTMLSuite.variableStorage.arrayDSObjects[this.objectIndex]=this}
DHTMLSuite.tableWidgetPageHandler.prototype={setTableRef:function(tableRef){this.tableRef=tableRef;this.tableRef.setPageHandler(this)},setTargetId:function(idOfHTMLElement){if(!document.getElementById(idOfHTMLElement)){alert('ERROR IN tableWidgetPageHandler.setTargetId:\nElement with id '+idOfHTMLElement+' does not exists');return}
this.targetRef=document.getElementById(idOfHTMLElement)},setTxtPrevious:function(newText){this.txtPrevious=newText},setLinkPagePrefix:function(linkPagePrefix){this.linkPagePrefix=linkPagePrefix},setLinkPageSuffix:function(linkPageSuffix){this.linkPageSuffix=linkPageSuffix},setTxtNext:function(newText){this.txtNext=newText},setTxtResultOf:function(txtResultOf){this.txtResultOf=txtResultOf},setTxtResultTo:function(txtResultTo){this.txtResultTo=txtResultTo},setTxtResultPrefix:function(txtResultPrefix){this.txtResultPrefix=txtResultPrefix},setTxtFirstPage:function(txtFirst){this.txtFirst=txtFirst},setTxtLastPage:function(txtLast){this.txtLast=txtLast},setTotalNumberOfRows:function(totalNumberOfRows){this.totalNumberOfRows=totalNumberOfRows},setCallbackOnAfterNavigate:function(callbackOnAfterNavigate){this.callbackOnAfterNavigate=callbackOnAfterNavigate},setLayoutCss:function(layoutCSS){this.layoutCSS=layoutCSS},setMaximumNumberOfPageLinks:function(maximumNumberOfPageLinks){this.maximumNumberOfPageLinks=maximumNumberOfPageLinks},init:function(){this.rowsPerPage=this.tableRef.getServersideSortNumberOfRows();DHTMLSuite.commonObj.loadCSS(this.layoutCSS);this.__createMainDivEls();this.setHTMLOfResultList();this.__createPageLinks();this.goToPage(1)},__createMainDivEls:function(){if(!this.targetRef){alert('Error creating table widget page handler. Remember to specify targetRef');return}
this.mainDivEl=document.createElement('DIV');this.mainDivEl.className='DHTMLSuite_tableWidgetPageHandler_mainDiv';this.targetRef.appendChild(this.mainDivEl);this.resultDivElement=document.createElement('DIV');this.resultDivElement.className='DHTMLSuite_tableWidgetPageHandler_result';this.mainDivEl.appendChild(this.resultDivElement);this.pageListDivEl=document.createElement('DIV');this.pageListDivEl.className='DHTMLSuite_tableWidgetPageHandler_pageList';this.mainDivEl.appendChild(this.pageListDivEl)},setHTMLOfResultList:function(){this.resultDivElement.innerHTML='';var html=this.txtResultPrefix+(((this.activePageNumber-1)*this.rowsPerPage)+1)+' '+this.txtResultTo+' '+Math.min(this.totalNumberOfRows,(this.activePageNumber*this.rowsPerPage))+' '+this.txtResultOf+' '+this.totalNumberOfRows;this.resultDivElement.innerHTML=html},__createPageLinks:function(){var ind=this.objectIndex;this.pageListDivEl.innerHTML='';var numberOfPages=Math.ceil(this.totalNumberOfRows/this.rowsPerPage);if(this.maximumNumberOfPageLinks&&this.maximumNumberOfPageLinks<numberOfPages){var span=document.createElement('SPAN');span.innerHTML=this.linkPagePrefix;this.pageListDivEl.appendChild(span);span.className='DHTMLSuite_pageHandler_firstLink';var fl=document.createElement('A');fl.innerHTML=this.txtFirst;fl.href='#';fl.id='pageLink_1';fl.onclick=function(e){return DHTMLSuite.variableStorage.arrayDSObjects[ind].__navigate(e)}
span.appendChild(fl);DHTMLSuite.commonObj.__addEventEl(fl)}
var span=document.createElement('SPAN');span.innerHTML=this.linkPagePrefix;this.pageListDivEl.appendChild(span);span.className='DHTMLSuite_pageHandler_previousLink';var previousLink=document.createElement('A');previousLink.innerHTML=this.txtPrevious;previousLink.href='#';previousLink.id='previous';previousLink.onclick=function(e){return DHTMLSuite.variableStorage.arrayDSObjects[ind].__navigate(e)}
span.appendChild(previousLink);DHTMLSuite.commonObj.__addEventEl(previousLink);if(this.activePageNumber==1)previousLink.className='previousLinkDisabled';else previousLink.className='previousLink';var startNumberToShow=1;var endNumberToShow=numberOfPages;if(this.maximumNumberOfPageLinks&&this.maximumNumberOfPageLinks<numberOfPages){startNumberToShow=Math.max(1,Math.round(this.activePageNumber-this.maximumNumberOfPageLinks/2));endNumberToShow=Math.min(numberOfPages,startNumberToShow+this.maximumNumberOfPageLinks-1);if(endNumberToShow-startNumberToShow < this.maximumNumberOfPageLinks){startNumberToShow=Math.max(1,endNumberToShow-this.maximumNumberOfPageLinks+1)}}
for(var no=startNumberToShow;no<=endNumberToShow;no++){var span=document.createElement('SPAN');span.innerHTML=this.linkPagePrefix;this.pageListDivEl.appendChild(span);var pageLink=document.createElement('A');if(no==this.activePageNumber)pageLink.className='DHTMLSuite_tableWidgetPageHandler_activePage';else pageLink.className='DHTMLSuite_tableWidgetPageHandler_inactivePage';pageLink.innerHTML=no;pageLink.href= '#';pageLink.id='pageLink_'+no;pageLink.onclick=function(e){return DHTMLSuite.variableStorage.arrayDSObjects[ind].__navigate(e)}
DHTMLSuite.commonObj.__addEventEl(pageLink);this.pageListDivEl.appendChild(pageLink);var span=document.createElement('SPAN');span.innerHTML=this.linkPageSuffix;this.pageListDivEl.appendChild(span)}
var span=document.createElement('SPAN');span.innerHTML=this.linkPagePrefix;this.pageListDivEl.appendChild(span);span.className='DHTMLSuite_pageHandler_nextLink';var nextLink=document.createElement('A');nextLink.innerHTML=this.txtNext;nextLink.id='next';nextLink.href='#';nextLink.onclick=function(e){return DHTMLSuite.variableStorage.arrayDSObjects[ind].__navigate(e)}
DHTMLSuite.commonObj.__addEventEl(nextLink);span.appendChild(nextLink);if(this.activePageNumber==numberOfPages)nextLink.className='nextLinkDisabled';else nextLink.className='nextLink';if(this.maximumNumberOfPageLinks&&this.maximumNumberOfPageLinks<numberOfPages){var span=document.createElement('SPAN');span.innerHTML=this.linkPagePrefix;this.pageListDivEl.appendChild(span);span.className='DHTMLSuite_pageHandler_lastLink';var ll=document.createElement('A');ll.innerHTML=this.txtLast;ll.href='#';ll.id='pageLink_'+(numberOfPages);ll.onclick=function(e){return DHTMLSuite.variableStorage.arrayDSObjects[ind].__navigate(e)}
span.appendChild(ll);DHTMLSuite.commonObj.__addEventEl(ll)}},__navigate:function(e){if(document.all)e=event;var src=DHTMLSuite.commonObj.getSrcElement(e);var initActivePageNumber=this.activePageNumber;var numberOfPages=Math.ceil(this.totalNumberOfRows/this.rowsPerPage);if(src.id.indexOf('pageLink_')>=0){var pageNo=src.id.replace(/[^0-9]/gi,'')/1;this.activePageNumber=pageNo}
if(src.id=='next'){this.activePageNumber++;if(this.activePageNumber>numberOfPages)this.activePageNumber=numberOfPages}
if(src.id=='previous'){this.activePageNumber--;if(this.activePageNumber<1)this.activePageNumber=1}
if(this.activePageNumber!=initActivePageNumber){this.tableRef.serversideSortCurrentStartIndex=((this.activePageNumber-1)*this.rowsPerPage);this.tableRef.__getItemsFromServer(this.callbackOnAfterNavigate);this.setHTMLOfResultList();this.__createPageLinks()}
return false},__resetActivePageNumber:function(){this.activePageNumber=1;this.setHTMLOfResultList();this.__createPageLinks()},goToPage:function(pageNo){var initActivePageNumber=this.activePageNumber;this.activePageNumber=pageNo;if(this.activePageNumber!=initActivePageNumber){this.tableRef.serversideSortCurrentStartIndex=((this.activePageNumber-1)*this.rowsPerPage);this.tableRef.__getItemsFromServer(this.callbackOnAfterNavigate);this.setHTMLOfResultList();this.__createPageLinks()}}}
DHTMLSuite.tableWidget=function(){var tableWidget_okToSort;var activeColumn;var idOfTable;var tableObj;var widthOfTable;var heightOfTable;var columnSortArray;var layoutCSS;var noCssLayout;var serversideSort;var serversideSortAscending;var tableCurrentlySortedBy;var serversideSortFileName;var serversideSortNumberOfRows;var serversideSortCurrentStartIndex;var serversideSortExtraSearchCriterias;var pageHandler;var rowClickCallBackFunction;var objectIndex;this.serversideSort=false;this.serversideSortAscending=true;this.tableCurrentlySortedBy=false;this.serversideSortFileName=false;this.serversideSortCurrentStartIndex=0;this.serversideSortExtraSearchCriterias='';this.rowClickCallBackFunction=false;this.setRowDblClickCallBackFunction=false;try{if(!standardObjectsCreated)DHTMLSuite.createStandardObjects()}catch(e){alert('Include the dhtmlSuite-common.js file')}
this.objectIndex=DHTMLSuite.variableStorage.arrayDSObjects.length;DHTMLSuite.variableStorage.arrayDSObjects[this.objectIndex]=this}
DHTMLSuite.tableWidget.prototype={init:function(){this.tableWidget_okToSort=true;this.activeColumn=false;if(!this.layoutCSS)this.layoutCSS='table-widget.css';DHTMLSuite.commonObj.loadCSS(this.layoutCSS);this.__initTableWidget()},setLayoutCss:function(newCssFile){this.layoutCSS=newCSSFile},setRowClickCallBack:function(rowClickCallBackFunction){this.rowClickCallBackFunction=rowClickCallBackFunction},setRowDblClickCallBack:function(setRowDblClickCallBackFunction){this.setRowDblClickCallBackFunction=setRowDblClickCallBackFunction},setServerSideSort:function(serversideSort){this.serversideSort=serversideSort},setServersideSearchCriterias:function(serversideSortExtraSearchCriterias){this.serversideSortExtraSearchCriterias=serversideSortExtraSearchCriterias},getServersideSortNumberOfRows:function(serversideSort){return this.serversideSortNumberOfRows},setServersideSortNumberOfRows:function(serversideSortNumberOfRows){this.serversideSortNumberOfRows=serversideSortNumberOfRows},setServersideSortFileName:function(serversideSortFileName){this.serversideSortFileName=serversideSortFileName},setNoCssLayout:function(){this.noCssLayout=true},sortTableByColumn:function(columnIndex,howToSort){if(!howToSort)howToSort='ascending';var tableObj=document.getElementById(this.idOfTable);var firstRow=tableObj.rows[0];var tds=firstRow.cells;if(tds[columnIndex]&&this.columnSortArray[columnIndex]){this.__sortTable(tds[columnIndex],howToSort)}},setTableId:function(idOfTable){this.idOfTable=idOfTable;try{this.tableObj=document.getElementById(idOfTable)}catch(e){}},setTableWidth:function(width){this.widthOfTable=width},setTableHeight:function(height){this.heightOfTable=height},setColumnSort:function(columnSortArray){this.columnSortArray=columnSortArray},addNewRow:function(cellContent){var tObj=document.getElementById(this.idOfTable);var tb=tObj.getElementsByTagName('TBODY')[0];var row=tb.insertRow(-1);for(var no=0;no<cellContent.length;no++){var cell=row.insertCell(-1);cell.innerHTML=cellContent[no]}
this.__parseDataRows(tObj)},addNewColumn:function(columnContent,headerText,sortMethod){this.columnSortArray[this.columnSortArray.length]=sortMethod;var tableObj=document.getElementById(this.idOfTable);var tbody=tableObj.getElementsByTagName('TBODY')[0];var thead=tableObj.getElementsByTagName('THEAD')[0];var bodyRows=tbody.rows;var headerRows=thead.rows;cellIndexSubtract=1;if(DHTMLSuite.clientInfoObj.isMSIE)cellIndexSubtract=0;var headerCell=headerRows[0].insertCell(headerRows[0].cells.length-cellIndexSubtract);if(!this.noCssLayout)headerCell.className='DHTMLSuite_tableWidget_headerCell';headerCell.onselectstart=function(){return false};DHTMLSuite.commonObj.__addEventEl(headerCell);headerCell.innerHTML=headerText;if(sortMethod){this.__parseHeaderCell(headerCell)}else{headerCell.style.cursor='default'}
headerRows[0].cells[headerRows[0].cells.length-1].style.borderRightWidth='0px';headerRows[0].cells[headerRows[0].cells.length-2].style.borderRightWidth='1px';for(var no=0;no<columnContent.length;no++){var dataCell=bodyRows[no].insertCell(bodyRows[no].cells.length-cellIndexSubtract);dataCell.innerHTML=columnContent[no]}
this.__parseDataRows(tableObj)},setPageHandler:function(ref){this.pageHandler=ref},__handleCallBackFromEvent:function(e,action){if(document.all)e=event;var src=DHTMLSuite.commonObj.getSrcElement(e);if((action=='rowClick'||action=='rowDblClick')&&src.tagName.toLowerCase()!='tr'){while(src.tagName.toLowerCase()!='tr')src=src.parentNode}
this.__createCallBackJavascriptString(action,src)},__createCallBackJavascriptString:function(action,el){var callbackString="";switch(action){case "rowClick":if(!this.rowClickCallBackFunction)return;callbackString=this.rowClickCallBackFunction+'(el)';break;case "rowDblClick":if(!this.setRowDblClickCallBackFunction)return;callbackString=this.setRowDblClickCallBackFunction+'(el)';break}
this.__executeCallBack(callbackString,el)},__executeCallBack:function(callbackString,el){if(!callbackString)return;try{eval(callbackString)}catch(e){}},__parseHeaderCell:function(cellRef){if(!this.noCssLayout){cellRef.onmouseover=this.__highlightTableHeader;cellRef.onmouseout= this.__removeHighlightEffectFromTableHeader;cellRef.onmousedown=this.__mousedownOnTableHeader;cellRef.onmouseup=this.__highlightTableHeader}else{cellRef.style.cursor='pointer'}
var refToThis=this;cellRef.onclick=function(){refToThis.__sortTable(this)};DHTMLSuite.commonObj.__addEventEl(cellRef);var img=document.createElement('IMG');img.src=DHTMLSuite.configObj.imagePath+'table-widget/arrow_up.gif';cellRef.appendChild(img);img.style.visibility='hidden'},__parseDataRows:function(parentObj){var ind=this.objectIndex;for(var no=1;no<parentObj.rows.length;no++){if(!this.noCssLayout){parentObj.rows[no].onmouseover=this.__highlightTableRow;parentObj.rows[no].onmouseout=this.__removeHighlightEffectFromTableRow}
parentObj.rows[no].onclick=function(e){DHTMLSuite.variableStorage.arrayDSObjects[ind].__handleCallBackFromEvent(e,'rowClick')};parentObj.rows[no].ondblclick=function(e){DHTMLSuite.variableStorage.arrayDSObjects[ind].__handleCallBackFromEvent(e,'rowDblClick')};DHTMLSuite.commonObj.__addEventEl(parentObj.rows[no]);for(var no2=0;no2<this.columnSortArray.length;no2++){try{if(this.columnSortArray[no2]&&this.columnSortArray[no2]=='N')parentObj.rows[no].cells[no2].style.textAlign='right'}catch(e){alert('Error in __parseDataRows method-row: '+no+',column:'+no2)}}}
for(var no2=0;no2<this.columnSortArray.length;no2++){if(this.columnSortArray[no2]&&this.columnSortArray[no2]=='N')parentObj.rows[0].cells[no2].style.textAlign='right'}},__initTableWidget:function(){if(!this.columnSortArray)this.columnSortArray=new Array();this.widthOfTable=this.widthOfTable+'';this.heightOfTable=this.heightOfTable+'';var obj=document.getElementById(this.idOfTable);obj.parentNode.className='DHTMLSuite_widget_tableDiv';if(navigator.userAgent.toLowerCase().indexOf('safari')==-1&&!this.noCssLayout){if(!DHTMLSuite.clientInfoObj.isMSIE)
obj.parentNode.style.overflow='hidden';else {obj.parentNode.style.overflowX='hidden';obj.parentNode.style.overflowY='scroll'}}
if(!this.noCssLayout){if(this.widthOfTable.indexOf('%')>=0){obj.style.width='100%';obj.parentNode.style.width=this.widthOfTable}else{obj.style.width=this.widthOfTable+'px';obj.parentNode.style.width=this.widthOfTable+'px'}
if(this.heightOfTable.indexOf('%')>=0){obj.parentNode.style.height=this.heightOfTable}else{obj.parentNode.style.height=this.heightOfTable+'px'}}
if(!DHTMLSuite.clientInfoObj.isMSIE){this.__addEndCol(obj)}else{obj.style.cssText='width:expression(this.parentNode.clientWidth)'}
obj.cellSpacing=0;obj.cellPadding=0;if(!this.noCssLayout)obj.className='DHTMLSuite_tableWidget';var tHead=obj.getElementsByTagName('THEAD')[0];var cells=tHead.getElementsByTagName('TD');var tBody=obj.getElementsByTagName('TBODY')[0];tBody.className='DHTMLSuite_scrollingContent';for(var no=0;no<cells.length;no++){if(!this.noCssLayout)cells[no].className='DHTMLSuite_tableWidget_headerCell';cells[no].onselectstart=function(){return false};DHTMLSuite.commonObj.__addEventEl(cells[no]);if(no==cells.length-1&&!this.noCssLayout){cells[no].style.borderRightWidth='0px'}
if(this.columnSortArray[no]){this.__parseHeaderCell(cells[no])}else{cells[no].style.cursor='default'}}
if(!this.noCssLayout){var tBody=obj.getElementsByTagName('TBODY')[0];if(document.all&&navigator.userAgent.indexOf('Opera')<0){tBody.className='DHTMLSuite_scrollingContent';tBody.style.display='block'}else{if(!this.noCssLayout)tBody.className='DHTMLSuite_scrollingContent';tBody.style.height=(obj.parentNode.clientHeight-tHead.offsetHeight)+'px';if(navigator.userAgent.indexOf('Opera')>=0){obj.parentNode.style.overflow='auto'}}}
this.__parseDataRows(obj);var ind=this.objectIndex},__addEndCol:function(obj){var rows=obj.getElementsByTagName('TR');for(var no=0;no<rows.length;no++){var cell=rows[no].insertCell(rows[no].cells.length);cell.innerHTML='<img src="'+DHTMLSuite.configObj.imagePath+'table-widget/transparent.gif" width="10" style="visibility:hidden">';cell.style.width='13px';cell.width='13';cell.style.overflow='hidden'}},__highlightTableHeader:function(){this.className='DHTMLSuite_tableWigdet_headerCellOver';if(document.all){var divObj=this.parentNode.parentNode.parentNode.parentNode;this.parentNode.style.top=divObj.scrollTop+'px'}},__removeHighlightEffectFromTableHeader:function(){this.className='DHTMLSuite_tableWidget_headerCell'},__mousedownOnTableHeader:function(){this.className='DHTMLSuite_tableWigdet_headerCellDown';if(document.all){var divObj=this.parentNode.parentNode.parentNode.parentNode;this.parentNode.style.top=divObj.scrollTop+'px'}},__sortNumeric:function(a,b){a=a.replace(/,/,'.');b=b.replace(/,/,'.');a=a.replace(/[^\d\.\/]/g,'');b=b.replace(/[^\d\.\/]/g,'');if(a.indexOf('/')>=0)a=eval(a);if(b.indexOf('/')>=0)b=eval(b);return a/1-b/1},__sortString:function(a,b){if(a.toUpperCase()< b.toUpperCase())return-1;if(a.toUpperCase()> b.toUpperCase())return 1;return 0},__parseDataContentFromServer:function(ajaxIndex){var content=DHTMLSuite.variableStorage.ajaxObjects[ajaxIndex].response;if(content.indexOf('|||')==-1&&content.indexOf('###')==-1){alert('Error in data from server\n'+content);return}
this.__clearDataRows();var rows=content.split('|||');for(var no=0;no<rows.length;no++){var items=rows[no].split('###');if(items.length>1)this.__fillDataRow(items)}
this.__parseDataRows(this.tableObj)},__clearDataRows:function(){if(!this.tableObj)this.tableObj=document.getElementById(this.idOfTable);while(this.tableObj.rows.length>1){DHTMLSuite.discardElement(this.tableObj.rows[this.tableObj.rows.length-1])}},__fillDataRow:function(data){if(!this.tableObj)this.tableObj=document.getElementById(this.idOfTable);var tbody=this.tableObj.getElementsByTagName('TBODY')[0];var row=tbody.insertRow(-1);for(var no=0;no<data.length;no++){var cell=row.insertCell(no);cell.innerHTML=data[no]}},updateTableHeader:function(columnIndex,direction){var tableObj=document.getElementById(this.idOfTable);var firstRow=tableObj.rows[0];var tds=firstRow.cells;var tdObj=tds[columnIndex];tdObj.setAttribute('direction',direction);tdObj.direction=direction;var sortBy=tdObj.getAttribute('sortBy');if(!sortBy)sortBy=tdObj.sortBy;this.tableCurrentlySortedBy=sortBy;this.__updateSortArrow(tdObj,direction)},reloadDataFromServer:function(){this.__getItemsFromServer();if(this.pageHandler)this.pageHandler.__resetActivePageNumber()},resetServersideSortCurrentStartIndex:function(){this.serversideSortCurrentStartIndex=0},__updateSortArrow:function(obj,direction){var images=obj.getElementsByTagName('IMG');if(direction=='descending'){images[0].src=images[0].src.replace('arrow_up','arrow_down');images[0].style.visibility='visible'}else{images[0].src=images[0].src.replace('arrow_down','arrow_up');images[0].style.visibility='visible'}
if(this.activeColumn&&this.activeColumn!=obj){var images=this.activeColumn.getElementsByTagName('IMG');images[0].style.visibility='hidden';this.activeColumn.removeAttribute('direction')}
this.activeColumn=obj},__getParsedCallbackString:function(functionName){var objIndex=this.objectIndex;if(!functionName)
functionName='true';else
functionName=functionName+'(DHTMLSuite.variableStorage.arrayDSObjects['+objIndex+'])';return functionName},__getItemsFromServer:function(callbackFunction){callbackFunction=this.__getParsedCallbackString(callbackFunction);var objIndex=this.objectIndex;var sembol='?';if(this.serversideSortFileName.indexOf('?')> 0)
sembol='&';var url=this.serversideSortFileName+sembol+'sortBy='+this.tableCurrentlySortedBy+'&numberOfRows='+this.serversideSortNumberOfRows+'&sortAscending='+this.serversideSortAscending+'&startIndex='+this.serversideSortCurrentStartIndex+this.serversideSortExtraSearchCriterias;var index=DHTMLSuite.variableStorage.ajaxObjects.length;try{DHTMLSuite.variableStorage.ajaxObjects[index]=new sack()}catch(e){alert('Unable to create ajax object. Please make sure that the sack js file is included on your page(js/ajax.js)');return}
DHTMLSuite.variableStorage.ajaxObjects[index].requestFile=url;DHTMLSuite.variableStorage.ajaxObjects[index].onCompletion=function(){DHTMLSuite.variableStorage.arrayDSObjects[objIndex].__parseDataContentFromServer(index);eval(callbackFunction)};DHTMLSuite.variableStorage.ajaxObjects[index].runAJAX()},__sortTable:function(obj,howToSort){if(this.serversideSort){if(!this.serversideSortFileName){alert('No server side file defined. Use the setServersideSortFileName to specify where to send the ajax request');return}
var sortBy=obj.getAttribute('sortBy');if(!sortBy)sortBy=obj.sortBy;if(!sortBy){alert('Sort is not defined. Remember to set a sortBy attribute on the header <td> tags');return}
if(sortBy==this.tableCurrentlySortedBy)this.serversideSortAscending=!this.serversideSortAscending;else this.serversideSortAscending=true;if(howToSort)this.serversideSortAscending=(howToSort=='ascending'?true:false);this.tableCurrentlySortedBy=sortBy;this.serversideSortCurrentStartIndex =0;this.__getItemsFromServer();if(this.pageHandler)this.pageHandler.__resetActivePageNumber();this.__updateSortArrow(obj,this.serversideSortAscending?'ascending':'descending');return}
if(!this.tableWidget_okToSort)return;this.tableWidget_okToSort=false;var indexThis=0;var tmpObj=obj;while(tmpObj.previousSibling){tmpObj=tmpObj.previousSibling;if(tmpObj.tagName=='TD')indexThis++}
if(obj.getAttribute('direction')||obj.direction){direction=obj.getAttribute('direction');if(navigator.userAgent.indexOf('Opera')>=0)direction=obj.direction;if(direction=='ascending'||howToSort=='descending'){direction='descending';obj.setAttribute('direction','descending');obj.direction='descending'}else{direction='ascending';obj.setAttribute('direction','ascending');obj.direction='ascending'}}else{var curDir='ascending';if(howToSort)curDir=howToSort;direction=curDir;obj.setAttribute('direction',curDir);obj.direction=curDir}
this.__updateSortArrow(obj,direction);var tableObj=obj.parentNode.parentNode.parentNode;var tBody=tableObj.getElementsByTagName('TBODY')[0];var widgetIndex=tableObj.id.replace(/[^\d]/g,'');var sortMethod=this.columnSortArray[indexThis];var cellArray=new Array();var cellObjArray=new Array();for(var no=1;no<tableObj.rows.length;no++){var content= tableObj.rows[no].cells[indexThis].innerHTML+'';cellArray.push(content);cellObjArray.push(tableObj.rows[no].cells[indexThis])}
if(sortMethod=='N'){cellArray=cellArray.sort(this.__sortNumeric)}else{cellArray=cellArray.sort(this.__sortString)}
if(direction=='descending'){for(var no=cellArray.length;no>=0;no--){for(var no2=0;no2<cellObjArray.length;no2++){if(cellObjArray[no2].innerHTML==cellArray[no]&&!cellObjArray[no2].getAttribute('allreadySorted')){cellObjArray[no2].setAttribute('allreadySorted','1');tBody.appendChild(cellObjArray[no2].parentNode)}}}}else{for(var no=0;no<cellArray.length;no++){for(var no2=0;no2<cellObjArray.length;no2++){if(cellObjArray[no2].innerHTML==cellArray[no]&&!cellObjArray[no2].getAttribute('allreadySorted')){cellObjArray[no2].setAttribute('allreadySorted','1');tBody.appendChild(cellObjArray[no2].parentNode)}}}}
for(var no2=0;no2<cellObjArray.length;no2++){cellObjArray[no2].removeAttribute('allreadySorted')}
this.tableWidget_okToSort=true},__highlightTableRow:function(){if(DHTMLSuite.clientInfoObj.isOpera)return;this.className='DHTMLSuite_tableWidget_dataRollOver';if(document.all){var divObj=this.parentNode.parentNode.parentNode;var tHead=divObj.getElementsByTagName('TR')[0];tHead.style.top=divObj.scrollTop+'px'}},__removeHighlightEffectFromTableRow:function(){if(DHTMLSuite.clientInfoObj.isOpera)return;this.className=null;if(document.all){var divObj=this.parentNode.parentNode.parentNode;var tHead=divObj.getElementsByTagName('TR')[0];tHead.style.top=divObj.scrollTop+'px'}}}
var DHTMLSuite_dragDropSimple_curZIndex=100000;var DHTMLSuite_dragDropSimple_curObjIndex=false;DHTMLSuite.dragDropSimple=function(propertyArray){var divElement;var dragTimer;var cloneNode;this.cloneNode=true;var callbackOnAfterDrag;var callbackOnBeforeDrag;var callbackOnDuringDrag;var mouse_x;var mouse_y;var positionSet;var dragHandle;var allowMoveX;var allowMoveY;var maxY;var minY;var minX;var maxX;var initialXPos;var initialYPos;this.positionSet=false;this.dragHandle=new Array();var initOffsetX;var initOffsetY;this.allowMoveX=true;this.allowMoveY=true;this.maxY=false;this.maxX=false;this.minX=false;this.minY=false;this.callbackOnAfterDrag=false;this.callbackOnBeforeDrag=false;this.dragStatus=-1;try{if(!standardObjectsCreated)DHTMLSuite.createStandardObjects()}catch(e){alert('Include the dhtmlSuite-common.js file')}
var objectIndex;this.objectIndex=DHTMLSuite.variableStorage.arrayDSObjects.length;DHTMLSuite.variableStorage.arrayDSObjects[this.objectIndex]=this;this.__setInitProps(propertyArray);this.__init()}
DHTMLSuite.dragDropSimple.prototype={__setInitProps:function(props){if(props.cloneNode===false||props.cloneNode)this.cloneNode=props.cloneNode;if(props.allowMoveX===false||props.allowMoveX)this.allowMoveX=props.allowMoveX;if(props.allowMoveY===false||props.allowMoveY)this.allowMoveY=props.allowMoveY;if(props.minY||props.minY===0)this.minY=props.minY;if(props.maxY||props.maxY===0)this.maxY=props.maxY;if(props.minX||props.minX===0)this.minX=props.minX;if(props.maxX||props.maxX===0)this.maxX=props.maxX;if(!props.initOffsetX)props.initOffsetX=0;if(!props.initOffsetY)props.initOffsetY=0;this.initOffsetX=props.initOffsetX;this.initOffsetY=props.initOffsetY;if(props.callbackOnBeforeDrag)this.callbackOnBeforeDrag=props.callbackOnBeforeDrag;if(props.callbackOnAfterDrag)this.callbackOnAfterDrag=props.callbackOnAfterDrag;if(props.callbackOnDuringDrag)this.callbackOnDuringDrag=props.callbackOnDuringDrag;props.elementReference=DHTMLSuite.commonObj.getEl(props.elementReference);this.divElement=props.elementReference;this.initialXPos=DHTMLSuite.commonObj.getLeftPos(this.divElement);this.initialYPos=DHTMLSuite.commonObj.getTopPos(this.divElement);if(props.dragHandle)this.dragHandle[this.dragHandle.length]=DHTMLSuite.commonObj.getEl(props.dragHandle)
},__init:function(){var ind=this.objectIndex;this.divElement.objectIndex=ind;this.divElement.setAttribute('objectIndex',ind);this.divElement.style.padding='0px';if(this.allowMoveX){this.divElement.style.left=(DHTMLSuite.commonObj.getLeftPos(this.divElement)+this.initOffsetX)+'px'}
if(this.allowMoveY){this.divElement.style.top=(DHTMLSuite.commonObj.getTopPos(this.divElement)+this.initOffsetY)+'px'}
this.divElement.style.position='absolute';this.divElement.style.margin='0px';if(this.divElement.style.zIndex&&this.divElement.style.zIndex/1>DHTMLSuite_dragDropSimple_curZIndex)DHTMLSuite_dragDropSimple_curZIndex=this.divElement.style.zIndex/1;DHTMLSuite_dragDropSimple_curZIndex=DHTMLSuite_dragDropSimple_curZIndex/1+1;this.divElement.style.zIndex=DHTMLSuite_dragDropSimple_curZIndex;if(this.cloneNode){var copy=this.divElement.cloneNode(true);this.divElement.parentNode.insertBefore(copy,this.divElement);copy.style.visibility='hidden';document.body.appendChild(this.divElement)}
DHTMLSuite.commonObj.addEvent(this.divElement,'mousedown',function(e){DHTMLSuite.variableStorage.arrayDSObjects[ind].__initDragProcess(e)},ind);DHTMLSuite.commonObj.addEvent(document.documentElement,'mousemove',function(e){DHTMLSuite.variableStorage.arrayDSObjects[ind].__moveDragableElement(e)},ind);DHTMLSuite.commonObj.addEvent(document.documentElement,'mouseup',function(e){DHTMLSuite.variableStorage.arrayDSObjects[ind].__stopDragProcess(e)},ind);if(!document.documentElement.onselectstart)document.documentElement.onselectstart=function(){return DHTMLSuite.commonObj.__isTextSelOk()}},setCallbackOnAfterDrag:function(functionName){this.callbackOnAfterDrag=functionName},setCallbackOnBeforeDrag:function(functionName){this.callbackOnBeforeDrag=functionName},addDragHandle:function(dragHandle){this.dragHandle[this.dragHandle.length]=dragHandle},__initDragProcess:function(e){if(document.all)e=event;var ind=this.objectIndex;DHTMLSuite_dragDropSimple_curObjIndex=ind;var thisObject=DHTMLSuite.variableStorage.arrayDSObjects[ind];if(!DHTMLSuite.commonObj.isObjectClicked(thisObject.divElement,e))return;if(thisObject.divElement.style.zIndex&&thisObject.divElement.style.zIndex/1>DHTMLSuite_dragDropSimple_curZIndex)DHTMLSuite_dragDropSimple_curZIndex=thisObject.divElement.style.zIndex/1;DHTMLSuite_dragDropSimple_curZIndex=DHTMLSuite_dragDropSimple_curZIndex/1+1;thisObject.divElement.style.zIndex=DHTMLSuite_dragDropSimple_curZIndex;if(thisObject.callbackOnBeforeDrag){thisObject.__handleCallback('beforeDrag',e)}
if(thisObject.dragHandle.length>0){var objectFound;for(var no=0;no<thisObject.dragHandle.length;no++){if(!objectFound)objectFound=DHTMLSuite.commonObj.isObjectClicked(thisObject.dragHandle[no],e)}
if(!objectFound)return}
DHTMLSuite.commonObj.__setTextSelOk(false);thisObject.mouse_x=e.clientX;thisObject.mouse_y=e.clientY;thisObject.el_x=thisObject.divElement.style.left.replace('px','')/1;thisObject.el_y=thisObject.divElement.style.top.replace('px','')/1;thisObject.dragTimer=0;thisObject.__waitBeforeDragProcessStarts();return false},__waitBeforeDragProcessStarts:function(){var ind=this.objectIndex;if(this.dragTimer>=0&&this.dragTimer<5){this.dragTimer++;setTimeout('DHTMLSuite.variableStorage.arrayDSObjects['+ind+'].__waitBeforeDragProcessStarts()',5)}},__moveDragableElement:function(e){if(document.all)e=event;var ind=this.objectIndex;var thisObj=DHTMLSuite.variableStorage.arrayDSObjects[ind];if(DHTMLSuite.clientInfoObj.isMSIE&&e.button!=1)return thisObj.__stopDragProcess();if(thisObj.dragTimer==5){if(thisObj.allowMoveX){var leftPos=(e.clientX-this.mouse_x+this.el_x);if(this.maxX!==false){if(leftPos+document.documentElement.scrollLeft>this.initialXPos+this.maxX){leftPos=this.initialXPos+this.maxX}}
if(this.minX!==false){if(leftPos+document.documentElement.scrollLeft<this.initialXPos+this.minX){leftPos=this.initialXPos+this.minX}}
thisObj.divElement.style.left =leftPos+'px'}
if(thisObj.allowMoveY){var topPos=(e.clientY-thisObj.mouse_y+thisObj.el_y);if(this.maxY!==false){if(topPos>this.initialYPos+this.maxY){topPos=this.initialYPos+this.maxY}}
if(this.minY!==false){if(topPos <this.initialYPos+this.minY){topPos=this.initialYPos+this.minY}}
thisObj.divElement.style.top=topPos+'px'}
if(this.callbackOnDuringDrag)this.__handleCallback('duringDrag',e)}
return false},__stopDragProcess:function(e){var ind=this.objectIndex;DHTMLSuite.commonObj.__setTextSelOk(true);var thisObj=DHTMLSuite.variableStorage.arrayDSObjects[ind];if(thisObj.dragTimer==5){thisObj.__handleCallback('afterDrag',e)}
thisObj.dragTimer=-1},__handleCallback:function(action,e){var callbackString='';switch(action){case "afterDrag":callbackString=this.callbackOnAfterDrag;break;case "beforeDrag":callbackString=this.callbackOnBeforeDrag;break;case "duringDrag":callbackString=this.callbackOnDuringDrag;break}
if(callbackString){callbackString=callbackString+'(e)';try{eval(callbackString)}catch(e){alert('Could not execute callback function('+callbackString+')after drag')}}},__setNewCurrentZIndex:function(zIndex){if(zIndex > DHTMLSuite_dragDropSimple_curZIndex){DHTMLSuite_dragDropSimple_curZIndex=zIndex/1+1}}}
DHTMLSuite.dragDrop=function(){var mouse_x;var mouse_y;var el_x;var el_y;var dragDropTimer;var numericIdToBeDragged;var dragObjCloneArray;var dragDropSourcesArray;var dragDropTargetArray;var currentZIndex;var okToStartDrag;var moveBackBySliding;var dragX_allowed;var dragY_allowed;var currentEl_allowX;var currentEl_allowY;var drag_minX;var drag_maxX;var drag_minY;var drag_maxY;var dragInProgress;try{if(!standardObjectsCreated)DHTMLSuite.createStandardObjects()}catch(e){alert('Include the dhtmlSuite-common.js file')}
this.dragX_allowed=true;this.dragY_allowed=true;this.currentZIndex=21000;this.dragDropTimer=-1;this.dragObjCloneArray=new Array();this.numericIdToBeDragged=false;this.okToStartDrag=true;this.moveBackBySliding=true;this.dragInProgress=false;var objectIndex;this.objectIndex=DHTMLSuite.variableStorage.arrayDSObjects.length;DHTMLSuite.variableStorage.arrayDSObjects[this.objectIndex]=this}
DHTMLSuite.dragDrop.prototype={init:function(){this.__initDragDropScript()},addSource:function(sourceId,slideBackAfterDrop,xAxis,yAxis,dragOnlyWithinElId){if(!this.dragDropSourcesArray)this.dragDropSourcesArray=new Array();if(!document.getElementById(sourceId)){alert('The source element with id '+sourceId+' does not exists. Check your HTML code');return}
if(xAxis!==false)xAxis=true;if(yAxis!==false)yAxis=true;var obj=document.getElementById(sourceId);this.dragDropSourcesArray[this.dragDropSourcesArray.length] =[obj,slideBackAfterDrop,xAxis,yAxis,dragOnlyWithinElId];obj.setAttribute('dragableElement',this.dragDropSourcesArray.length-1);obj.dragableElement=this.dragDropSourcesArray.length-1},addTarget:function(targetId,functionToCallOnDrop){if(!this.dragDropTargetArray)this.dragDropTargetArray=new Array();if(!document.getElementById(targetId))alert('The target element with id '+targetId+' does not exists.  Check your HTML code');var obj=document.getElementById(targetId);this.dragDropTargetArray[this.dragDropTargetArray.length] =[obj,functionToCallOnDrop]},setSlide:function(isSlidingAnimationEnabled){this.moveBackBySliding=isSlidingAnimationEnabled},__initDragDropScript:function(){var ind=this.objectIndex;var refToThis=this;var startIndex=Math.random()+'';startIndex=startIndex.replace('.','')/1;for(var no=0;no<this.dragDropSourcesArray.length;no++){var el=this.dragDropSourcesArray[no][0].cloneNode(true);var el2=this.dragDropSourcesArray[no][0];eval("el.onmousedown =function(e,index){DHTMLSuite.variableStorage.arrayDSObjects["+ind+"].__initializeDragProcess(e,"+no+")}");DHTMLSuite.commonObj.__addEventEl(el);var tmpIndex=startIndex+no;el.id=el2.id;el.style.position='absolute';el.style.visibility='hidden';el.style.display='none';document.body.appendChild(el);el.style.top=DHTMLSuite.commonObj.getTopPos(this.dragDropSourcesArray[no][0])+'px';el.style.left=DHTMLSuite.commonObj.getLeftPos(this.dragDropSourcesArr